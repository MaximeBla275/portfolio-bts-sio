<template>
  <PageWrapper>
    <!-- HERO -->
    <section class="relative border-b border-[var(--border)] overflow-hidden">
      <div class="h-56 md:h-72 relative flex items-center justify-center overflow-hidden">
        <div class="absolute inset-0" style="background-color: #b4530918" />
        <div class="absolute inset-0 flex items-center justify-center">
          <img
            src="/logos/cookson.svg"
            alt="Cookson-CLAL"
            class="w-2/3 md:w-1/2 max-w-xs object-contain opacity-10 select-none pointer-events-none"
          />
        </div>
        <div class="absolute inset-0 bg-gradient-to-t from-black/80 via-black/20 to-transparent" />
        <!-- Badge haut droite -->
        <div class="absolute top-4 right-4 z-10">
          <a
            href="/rapports/rapport-stage-cookson.pdf"
            download
            class="font-mono text-xs px-3 py-2 border border-white/30 text-white/70 hover:text-white hover:border-white transition-all flex items-center gap-2"
          >
            ‚Üì T√©l√©charger le rapport
          </a>
        </div>
        <!-- Infos bas gauche -->
        <div class="absolute bottom-4 left-6 z-10 flex items-center gap-3">
          <img src="/logos/cookson.svg" alt="Cookson-CLAL" class="w-10 h-10 object-contain bg-white/10 p-1 rounded" />
          <div>
            <p class="font-display font-black text-white text-lg leading-tight">Cookson-CLAL</p>
            <p class="font-mono text-xs text-white/50">Dardilly (69) ¬∑ Mai ‚Äî Juillet 2025</p>
          </div>
        </div>
      </div>
    </section>

    <div class="max-w-5xl mx-auto px-6 py-16 space-y-20">

      <!-- FICHE RAPIDE -->
      <section>
        <SectionHeader label="Informations" title="Fiche du stage" accent-word="stage" />
        <div class="grid grid-cols-2 md:grid-cols-4 gap-4 mt-8">
          <div v-for="info in infos" :key="info.label" class="border border-[var(--border)] p-4">
            <p class="font-mono text-xs uppercase tracking-widest text-[var(--muted)] mb-1">{{ info.label }}</p>
            <p class="font-mono text-sm font-medium">{{ info.value }}</p>
          </div>
        </div>
      </section>

      <!-- PR√âSENTATION ENTREPRISE -->
      <section>
        <SectionHeader label="02 ‚Äî Pr√©sentation" title="L'entreprise" accent-word="entreprise" />
        <div class="mt-8 grid md:grid-cols-2 gap-10">
          <div class="space-y-4">
            <p class="font-mono text-sm text-[var(--muted)] leading-relaxed">
              Cookson-CLAL est une entreprise sp√©cialis√©e dans l'achat et la vente de <strong class="text-[var(--ink)]">m√©taux pr√©cieux</strong>
              (or, argent, platine) ainsi que dans la fabrication d'outillage et de fournitures pour bijoutiers.
            </p>
            <p class="font-mono text-sm text-[var(--muted)] leading-relaxed">
              Elle fait partie du groupe international <strong class="text-[var(--ink)]">HM Precious Metals</strong>,
              dont le si√®ge social est bas√© en Allemagne. Le site de Dardilly (69) concentre les activit√©s
              commerciales et de service client pour la France.
            </p>
            <p class="font-mono text-sm text-[var(--muted)] leading-relaxed">
              L'informatique de l'entreprise s'appuie sur un parc Windows g√©r√© par un administrateur syst√®mes &amp; r√©seaux,
              avec des outils m√©tier sp√©cifiques au secteur industriel.
            </p>
          </div>
          <div class="space-y-3">
            <div v-for="item in entrepriseInfos" :key="item.label" class="flex gap-4 p-3 border border-[var(--border)]">
              <span class="text-lg">{{ item.icon }}</span>
              <div>
                <p class="font-mono text-xs text-[var(--muted)] uppercase tracking-widest">{{ item.label }}</p>
                <p class="font-mono text-sm font-medium">{{ item.value }}</p>
              </div>
            </div>
          </div>
        </div>
      </section>

      <!-- CONTEXTE -->
      <section>
        <SectionHeader label="01 ‚Äî Contexte" title="Probl√©matique" accent-word="Probl√©matique" />
        <div class="mt-8 grid md:grid-cols-2 gap-6">
          <div class="border border-[var(--border)] p-6 space-y-3">
            <h3 class="font-mono text-xs uppercase tracking-widest text-[var(--muted)]">Situation existante</h3>
            <ul class="space-y-2">
              <li v-for="pb in problemes" :key="pb" class="flex gap-3 font-mono text-sm">
                <span class="text-red-500 mt-0.5">‚úï</span>
                <span class="text-[var(--muted)]">{{ pb }}</span>
              </li>
            </ul>
          </div>
          <div class="border border-[var(--border)] p-6 space-y-3" style="border-color: #b45309">
            <h3 class="font-mono text-xs uppercase tracking-widest" style="color: #b45309">Objectif du stage</h3>
            <p class="font-mono text-sm text-[var(--muted)] leading-relaxed">
              R√©√©crire le script de connexion r√©seau (login) de l'entreprise, initialement √©crit en <strong class="text-[var(--ink)]">VBScript</strong>
              et devenu obsol√®te, en le traduisant en <strong class="text-[var(--ink)]">PowerShell</strong>.
            </p>
            <p class="font-mono text-sm text-[var(--muted)] leading-relaxed">
              Ce script est critique : il s'ex√©cute √† chaque d√©marrage de session Windows pour tous les employ√©s,
              configurant les lecteurs r√©seau, les applications et les autorisations selon le groupe de l'utilisateur.
            </p>
          </div>
        </div>
      </section>

      <!-- ENVIRONNEMENT TECHNIQUE -->
      <section>
        <SectionHeader label="04 ‚Äî Technique" title="L'informatique dans l'entreprise" accent-word="informatique" />
        <div class="mt-8 grid md:grid-cols-2 gap-6">
          <div v-for="tech in technologies" :key="tech.nom" class="border border-[var(--border)] p-5">
            <div class="flex items-start justify-between mb-3">
              <h3 class="font-mono text-sm font-bold">{{ tech.nom }}</h3>
              <span class="font-mono text-xs px-2 py-0.5 border border-[var(--border)] text-[var(--muted)]">{{ tech.date }}</span>
            </div>
            <p class="font-mono text-xs text-[var(--muted)] leading-relaxed">{{ tech.desc }}</p>
          </div>
        </div>
      </section>

      <!-- M√âTHODOLOGIE DE TRAVAIL -->
      <section>
        <SectionHeader label="05 ‚Äî Travaux" title="D√©roul√© de la mission" accent-word="mission" />
        <div class="mt-8 grid md:grid-cols-4 gap-4">
          <div v-for="(etape, i) in etapes" :key="etape.titre" class="border border-[var(--border)] p-5 relative">
            <span class="font-display font-black text-5xl text-[var(--border)] absolute top-3 right-3 leading-none select-none">
              0{{ i + 1 }}
            </span>
            <h3 class="font-mono text-xs font-bold uppercase tracking-widest mb-2">{{ etape.titre }}</h3>
            <p class="font-mono text-xs text-[var(--muted)] leading-relaxed">{{ etape.desc }}</p>
          </div>
        </div>
      </section>

      <!-- D√âTAIL DES TRAVAUX -->
      <section>
        <SectionHeader label="D√©tail" title="Ce que j'ai r√©alis√©" accent-word="r√©alis√©" />
        <div class="mt-8 space-y-6">
          <div v-for="travail in travaux" :key="travail.titre" class="border border-[var(--border)] p-6">
            <div class="flex items-center gap-3 mb-3">
              <span class="font-mono text-xs px-2 py-0.5 text-white text-[10px] uppercase tracking-widest" style="background: #b45309">{{ travail.tag }}</span>
              <h3 class="font-mono text-sm font-bold">{{ travail.titre }}</h3>
            </div>
            <p class="font-mono text-sm text-[var(--muted)] leading-relaxed">{{ travail.desc }}</p>
          </div>
        </div>
      </section>

      <!-- TECHNOLOGIES UTILIS√âES -->
      <section>
        <SectionHeader label="Stack" title="Technologies utilis√©es" accent-word="Technologies" />
        <div class="mt-8 flex flex-wrap gap-3">
          <TechTagList :tags="stack" />
        </div>
      </section>

      <!-- COMP√âTENCES BTS -->
      <section>
        <SectionHeader label="BTS SIO" title="Comp√©tences valid√©es" accent-word="Comp√©tences" />
        <div class="mt-8 grid md:grid-cols-2 gap-4">
          <div v-for="comp in competences" :key="comp.code" class="border border-[var(--border)] p-4 flex gap-4">
            <span class="font-mono text-xs px-2 py-1 h-fit" style="background: #b4530922; color: #b45309; border: 1px solid #b4530944">{{ comp.code }}</span>
            <div>
              <p class="font-mono text-sm font-medium">{{ comp.intitule }}</p>
              <p class="font-mono text-xs text-[var(--muted)] mt-1">{{ comp.detail }}</p>
            </div>
          </div>
        </div>
      </section>

      <!-- BILAN -->
      <section>
        <SectionHeader label="Bilan" title="Ce que j'en retiens" accent-word="retiens" />
        <div class="mt-8 grid md:grid-cols-3 gap-6">
          <div v-for="point in bilan" :key="point.titre" class="border border-[var(--border)] p-5">
            <p class="text-2xl mb-3">{{ point.icon }}</p>
            <h3 class="font-mono text-xs font-bold uppercase tracking-widest mb-2">{{ point.titre }}</h3>
            <p class="font-mono text-xs text-[var(--muted)] leading-relaxed">{{ point.desc }}</p>
          </div>
        </div>
      </section>

      <!-- RAPPORT PDF -->
      <section class="border border-[var(--border)] p-8 flex flex-col md:flex-row items-center justify-between gap-6">
        <div>
          <p class="font-mono text-xs uppercase tracking-widest text-[var(--muted)] mb-1">Document complet</p>
          <h3 class="font-display font-black text-2xl">Rapport de stage</h3>
          <p class="font-mono text-sm text-[var(--muted)] mt-2">Cookson-CLAL ¬∑ Mai ‚Äî Juillet 2025 ¬∑ 1√®re ann√©e BTS SIO</p>
        </div>
        <div class="flex gap-3">
          <a href="/rapports/rapport-stage-cookson.pdf" target="_blank">
            <BaseButton variant="outline">Ouvrir ‚Üó</BaseButton>
          </a>
          <a href="/rapports/rapport-stage-cookson.pdf" download>
            <BaseButton variant="solid">‚Üì T√©l√©charger</BaseButton>
          </a>
        </div>
      </section>

    </div>
  </PageWrapper>
</template>

<script setup>
import PageWrapper    from '@/components/templates/PageWrapper.vue'
import SectionHeader  from '@/components/molecules/SectionHeader.vue'
import TechTagList    from '@/components/molecules/TechTagList.vue'
import BaseButton     from '@/components/atoms/BaseButton.vue'

const infos = [
  { label: 'Entreprise',   value: 'Cookson-CLAL' },
  { label: 'Lieu',         value: 'Dardilly (69)' },
  { label: 'P√©riode',      value: 'Mai ‚Äî Juil. 2025' },
  { label: 'Promotion',    value: 'BTS SIO 1√®re ann√©e' },
]

const entrepriseInfos = [
  { icon: 'üè≠', label: 'Secteur',   value: 'Industrie ‚Äî M√©taux pr√©cieux & bijouterie' },
  { icon: 'üåç', label: 'Groupe',    value: 'HM Precious Metals (Si√®ge Allemagne)' },
  { icon: 'üìç', label: 'Adresse',   value: '69570 Dardilly' },
  { icon: 'üåê', label: 'Site web',  value: 'www.cookson-clal.com' },
]

const problemes = [
  'Le script VBScript de login √©tait partiellement obsol√®te',
  'Certaines applications et automatisations ne fonctionnaient plus',
  'Les utilisateurs devaient effectuer des √©tapes manuelles suppl√©mentaires au d√©marrage',
  'Le service informatique √©tait surcharg√© par des tickets mineurs',
  'Des interventions importantes √©taient interrompues faute de session stable',
]

const technologies = [
  { nom: 'AS400',             date: 'IBM ‚Äî 1988', desc: 'ERP historique de l\'entreprise utilis√© pour la gestion des stocks et des commandes de m√©taux pr√©cieux. Interface textuelle via terminal.' },
  { nom: 'LANSA',             date: 'IBM ‚Äî post AS400', desc: 'Langage et environnement de d√©veloppement li√© √† IBM, utilis√© en compl√©ment de l\'AS400 pour les interfaces plus r√©centes.' },
  { nom: 'VBScript',          date: 'Microsoft ‚Äî 1991', desc: 'Langage de script Microsoft, plus simple d\'utilisation. Utilis√© historiquement pour le script de login Windows ‚Äî devenu partiellement obsol√®te.' },
  { nom: 'PowerShell',        date: 'Microsoft ‚Äî 2006', desc: 'Langage de scripting moderne pour l\'automatisation des t√¢ches Windows. Rempla√ßant naturel du VBScript, plus puissant et maintenu activement.' },
]

const etapes = [
  { titre: 'Organisation',           desc: 'Planification des t√¢ches et prise de connaissance de l\'environnement IT de l\'entreprise.' },
  { titre: 'Compr√©hension/Traduction', desc: 'Analyse du script VBScript existant, compr√©hension de sa logique et r√©√©criture en PowerShell.' },
  { titre: 'Phase de test',          desc: 'Tests sur machine virtuelle puis sur poste physique, v√©rification des acc√®s et autorisations par groupe.' },
  { titre: 'Mise en place',          desc: 'D√©ploiement sur les postes utilisateurs r√©els, v√©rification de la signature mail et finalisation.' },
]

const travaux = [
  {
    tag: '01 ‚Äî Traduction',
    titre: 'R√©√©criture VBScript ‚Üí PowerShell',
    desc: 'Le travail principal consistait √† analyser et comprendre la logique du script VBScript existant (gestion des lecteurs r√©seau, groupes utilisateurs, applications au d√©marrage) puis √† le r√©√©crire compl√®tement en PowerShell. Les deux langages ont beaucoup de similarit√©s structurelles, ce qui a facilit√© la traduction. Le script g√®re notamment le montage de lecteurs r√©seau par d√©partement (Finance, Commerce, Informatique, Laboratoire, Lyon, Management, etc.).',
  },
  {
    tag: '02 ‚Äî Tests',
    titre: 'Phase de test multi-environnements',
    desc: 'Chaque groupe d\'utilisateurs (par d√©partement) a √©t√© test√© individuellement pour v√©rifier : le bon montage des lecteurs r√©seau, le lancement des applications m√©tier, les autorisations Active Directory, et la stabilit√© sur diff√©rents profils. Les tests ont √©t√© r√©alis√©s d\'abord sur machine virtuelle pour isoler les erreurs, puis sur un poste physique en conditions r√©elles.',
  },
  {
    tag: '03 ‚Äî D√©ploiement',
    titre: 'Mise en place et v√©rification de la signature mail',
    desc: 'Une fois le script valid√©, il a √©t√© rendu fonctionnel au d√©marrage de session via les Group Policy Objects (GPO) Windows. La signature de mail Outlook a √©galement √©t√© int√©gr√©e et v√©rifi√©e : elle est g√©n√©r√©e automatiquement avec les informations de l\'utilisateur connect√© (nom, poste, adresse, logo Cookson-CLAL).',
  },
]

const stack = ['PowerShell', 'VBScript', 'Windows Server', 'Active Directory', 'GPO', 'AS400', 'LANSA']

const competences = [
  { code: '1.1', intitule: 'Recenser et identifier les ressources num√©riques', detail: 'Inventaire du parc logiciel et des scripts existants' },
  { code: '1.2', intitule: 'Exploiter des r√©f√©rentiels, normes et standards', detail: 'Compr√©hension et application des standards PowerShell et GPO' },
  { code: '2.2', intitule: 'Collecter, suivre et orienter des demandes', detail: 'Analyse des besoins utilisateurs li√©s aux dysfonctionnements du script' },
  { code: '2.3', intitule: 'Traiter des demandes concernant les applications', detail: 'R√©solution des probl√®mes d\'applications au d√©marrage de session' },
  { code: '5.1', intitule: 'R√©aliser les tests d\'int√©gration et d\'acceptation', detail: 'Tests par groupes utilisateurs sur VM et postes physiques' },
  { code: '6.1', intitule: 'Mettre en place son environnement d\'apprentissage personnel', detail: 'Apprentissage autonome de PowerShell et VBScript en contexte professionnel' },
]

const bilan = [
  { icon: 'üß†', titre: 'Compr√©hension de l\'IT en entreprise', desc: 'Ce stage m\'a permis de d√©couvrir concr√®tement comment l\'informatique s\'int√®gre dans une entreprise industrielle, avec des contraintes r√©elles (production, utilisateurs non-techniques, s√©curit√© des donn√©es).' },
  { icon: 'üíª', titre: 'Mont√©e en comp√©tence technique', desc: 'J\'ai appris √† lire et comprendre du VBScript existant, √† ma√Ætriser PowerShell pour l\'automatisation Windows, et √† travailler sur Active Directory et les GPO.' },
  { icon: '‚öñÔ∏è', titre: 'Responsabilit√© et rigueur', desc: 'Le script impactant tous les postes de l\'entreprise, chaque modification demandait une rigueur absolue. Cette pression m\'a appris √† tester m√©thodiquement avant tout d√©ploiement.' },
]
</script>
